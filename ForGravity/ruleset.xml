<?xml version="1.0"?>
<ruleset name="ForGravity">
    <description>ForGravity Coding standards</description>

    <!-- Only scan PHP files. -->
    <arg name="extensions" value="php"/>

    <!-- Whenever possible, cache the scan results and re-use those for unchanged files on the next scan. -->
    <arg name="cache"/>

    <!-- Set the memory limit to 256M.
         For most standard PHP configurations, this means the memory limit will temporarily be raised.
         Ref: https://github.com/squizlabs/PHP_CodeSniffer/wiki/Advanced-Usage#specifying-phpini-settings
    -->
    <ini name="memory_limit" value="256M"/>

    <!-- Strip the filepaths down to the relevant bit. -->
    <arg name="basepath" value="./"/>

    <!-- Check up to 20 files simultaneously. -->
    <arg name="parallel" value="20"/>

    <!-- Show sniff codes in all reports. -->
    <arg value="ps"/>

    <!-- Exclude patterns -->
    <exclude-pattern>/node_modules/*</exclude-pattern>
    <exclude-pattern>/includes/vendor/*</exclude-pattern>
    <exclude-pattern>/tmp</exclude-pattern>
    <exclude-pattern>/class-edd-sl-plugin-updater.php</exclude-pattern>
    <!-- We may want to include tests later. -->
    <exclude-pattern>/tests/*</exclude-pattern>

    <!-- Rules -->
    <rule ref="WordPress-Core">
        <!-- Definitely should not be added back -->
        <exclude name="Generic.ControlStructures.InlineControlStructure.NotAllowed"/>
        <exclude name="Generic.Arrays.DisallowShortArraySyntax"/>
        <exclude name="WordPress.CodeAnalysis.AssignmentInCondition.Found"/>
        <exclude name="WordPress.WhiteSpace.ControlStructureSpacing.BlankLineAfterEnd"/>

        <!-- Should probably not be added back -->
        <exclude name="Squiz.PHP.DisallowMultipleAssignments.FoundInControlStructure"/>

        <!-- Should maybe Add Back Later -->
        <exclude name="WordPress.WP.I18n.MissingTranslatorsComment"/>
        <exclude name="PEAR.Functions.FunctionCallSignature.ContentAfterOpenBracket"/>
        <exclude name="PEAR.Functions.FunctionCallSignature.CloseBracketLine"/>
        <exclude name="PEAR.Functions.FunctionCallSignature.MultipleArguments"/>
    </rule>
    <rule ref="WordPress.CodeAnalysis.EmptyStatement"/>

    <!-- These rules are being set as warnings instead of errors, so we can error check the entire codebase. -->
    <rule ref="WordPress.NamingConventions.ValidVariableName.VariableNotSnakeCase">
        <type>warning</type>
    </rule>
    <rule ref="WordPress.DB.PreparedSQL.InterpolatedNotPrepared">
        <type>warning</type>
    </rule>
    <rule ref="WordPress.DB.PreparedSQL.NotPrepared">
        <type>warning</type>
    </rule>
    <rule ref="WordPress.Files.FileName.InvalidClassFileName">
        <type>warning</type>
    </rule>

    <!-- Enforce no parenthesis for language constructs, and only one space immediately after.
         Including this rule is temporary until it is moved from the WordPress-Extra ruleset to
         the WordPress-Core ruleset upstream.
    -->
    <rule ref="PEAR.Files.IncludingFile.BracketsNotRequired">
        <type>warning</type>
    </rule>
    <rule ref="PEAR.Files.IncludingFile.UseRequire">
        <type>warning</type>
    </rule>
    <rule ref="PEAR.Files.IncludingFile.UseRequireOnce">
        <type>warning</type>
    </rule>
    <rule ref="Squiz.WhiteSpace.LanguageConstructSpacing"/>

    <rule ref="WordPress">
        <!-- This is Rocketgenius coding standards. -->
        <exclude name="WordPress.PHP.YodaConditions" />
        <exclude name="WordPress.PHP.StrictComparisons"/>
        <exclude name="WordPress.PHP.StrictInArray"/>
        <exclude name="WordPress.NamingConventions.ValidVariableName"/>

        <!-- Assignments in while conditions are a valid method of looping over iterables. -->
        <exclude name="WordPress.CodeAnalysis.AssignmentInCondition.FoundInWhileCondition" />
    </rule>

    <rule ref="PHPCompatibilityWP"/>

</ruleset>